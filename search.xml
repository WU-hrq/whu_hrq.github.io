<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[JavaÁ∫øÁ®ãÊ±†ÊµÖÊûê]]></title>
    <url>%2F2018%2F06%2F23%2FExecutors%2F</url>
    <content type="text"><![CDATA[JavaÁ∫øÁ®ãÊ±†ExecutorsÁÆÄÂçïÊ∫êÁ†ÅÂàÜÊûê ExecutorsÔºöÂàõÂª∫Á∫øÁ®ãÊ±†Á±ªÂûã newCachedThreadPool() ËøîÂõû‰∏çÈôêÂÆöÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†ÔºåËã•Êó†‰ªªÂä°Âàô‰∏çÂàõÂª∫Á∫øÁ®ãÔºåÊù•‰ªªÂä°Êó∂ÂàõÂª∫Á∫øÁ®ãÊâßË°åÔºåÂπ∂‰∏îÊØè‰∏™Á©∫Èó≤Á∫øÁ®ã‰ºöÂú®60ÁßíÂêéË¢´ÂõûÊî∂newFixedThreadPool() ËøîÂõûÂõ∫ÂÆöÁ∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†ÔºåÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÂíåÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÊòØ‰∏ÄÊ†∑ÁöÑnewScheduledThreadPool() ÂèØÊåáÂÆöÊ†∏ÂøÉÁ∫øÁ®ãÊï∞Èáè ÊèêÂâçËØ¥Êòé‰∏ãÔºåËøôÂá†ÁßçÁ∫øÁ®ãÊ±†Â∫ïÂ±ÇÈÉΩÊòØË∞ÉÁî®ÁöÑThreadPoolExecutorÁ±ªÂØπË±°ÔºåThreadPoolExecutorÁ±ªÊûÑÈÄ†ÊñπÊ≥ïÂèÇÊï∞‰∏∫ÔºöÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÔºöcorePoolSizeÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÔºömaximumPoolSizeÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÁ∫øÁ®ãÂ≠òÊ¥ªÊó∂Èó¥ÔºökeepAliveTimeÁ¨¨Âõõ‰∏™ÂèÇÊï∞ÊòØTimeUnitÂØπË±°ÔºöTimeUnitÁ¨¨‰∫î‰∏™ÂèÇÊï∞ÊòØ‰ªªÂä°Á≠âÂæÖÈòüÂàóÔºöBlockingQueueÁ¨¨ÂÖ≠‰∏™ÂèÇÊï∞ÊòØÊãíÁªùÁ≠ñÁï•Ôºö(ÈªòËÆ§ÊòØ)AbortPolicy ‰∏ãÈù¢Áúã‰∏ãÊØèÁßçÁ∫øÁ®ãÊ±†Ôºö Executors.newCachedThreadPool():12345public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); &#125; CachedThreadPoolÁ∫øÁ®ãÊ±†ÊòØ‰∏çÈôêÂÆöÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†ÔºåËã•Êó†‰ªªÂä°Âà∞Êù•Âàô‰∏çÂàõÂª∫Á∫øÁ®ãÔºåÊù•‰ªªÂä°Êó∂ÂàõÂª∫Á∫øÁ®ãÊâßË°åÔºåÂπ∂‰∏îÊØè‰∏™Á©∫Èó≤Á∫øÁ®ã‰ºöÂú®60ÁßíÂêéË¢´ÂõûÊî∂„ÄÇÂÖ∂ÈááÁî®ÁöÑ‰ªªÂä°Á≠âÂæÖÈòüÂàóÊòØSynchronousQueueÔºåÊòØÊó†ÁºìÂÜ≤ÈòüÂàóÔºåÈòüÂàó‰∏≠‰∏çÊîæ‰ªªÂä°ÔºåÊù•‰ªªÂä°ÂêéÊñ∞Âª∫Á∫øÁ®ãÂπ∂Áõ¥Êé•‰∫§ÁªôÁ∫øÁ®ãÂ§ÑÁêÜÔºåËã•Êó†Á∫øÁ®ãÂèØÂàõÂª∫ÔºåÂàôÊâßË°åÊãíÁªùÁ≠ñÁï•„ÄÇ Executors.newFixedThreadPool(10):12345public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()); &#125; FixedThreadPoolÁ∫øÁ®ãÊ±†ËøîÂõûÂõ∫ÂÆöÁ∫øÁ®ãÊï∞ÈáèÁöÑÁ∫øÁ®ãÊ±†ÔºåÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÂíåÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇÂÖ∂ÈááÁî®ÁöÑ‰ªªÂä°Á≠âÂæÖÈòüÂàóÊòØLinkedBlockingDequeÔºåÊòØÊó†ÁïåÈòüÂàóÔºåÊù•‰ªªÂä°ÂêéÔºåËã•Á∫øÁ®ãÊ±†Á∫øÁ®ãÊï∞‰∏çË∂ÖËøáÊ†∏ÂøÉÁ∫øÁ®ãÊï∞,ÂàôÊñ∞Âª∫Á∫øÁ®ãÂ§ÑÁêÜËØ•‰ªªÂä°ÔºåËã•ËææÂà∞‰∫ÜÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÔºåÂàô‰∏ÄÁõ¥Â∞Ü‰ªªÂä°Âä†ÂÖ•Êó†ÁïåÈòüÂàóÔºåÁõ¥Âà∞ËÄóÂ∞ΩÁ≥ªÁªüËµÑÊ∫ê„ÄÇ Executors.newScheduledThreadPool(10):123456789101112131415public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) &#123; return new ScheduledThreadPoolExecutor(corePoolSize); &#125; //ScheduledThreadPoolExecutorÁ±ªÁªßÊâø‰∫ÜThreadPoolExecutorÁ±ªpublic class ScheduledThreadPoolExecutor extends ThreadPoolExecutor implements ScheduledExecutorServicepublic ScheduledThreadPoolExecutor(int corePoolSize) &#123; super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS, new DelayedWorkQueue()); &#125; ÂèØ‰ª•ÁúãÂà∞ScheduledThreadPoolÁ∫øÁ®ãÊ±†Â∫ïÂ±Ç‰πüÊòØË∞ÉÁî®ThreadPoolExecutorÁ±ªÔºåÂàõÂª∫Êó∂ÊåáÂÆöÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÈáèÂç≥ÂèØ„ÄÇÂÖ∂ÈááÁî®ÁöÑ‰ªªÂä°Á≠âÂæÖÈòüÂàóÊòØDelayedWorkQueueÔºåÊòØÂª∂ËøüÈòüÂàóÔºåÂèØ‰ª•ËÆæÂÆö‰ªªÂä°Âª∂ËøüÂ§ö‰πÖÂÜçÊâßË°å„ÄÇËøòÊúâÁßç‰ªªÂä°Á≠âÂæÖÈòüÂàóÊòØÊúâÁïåÈòüÂàóÔºöArrayBlockingQueueÔºå‰ΩøÁî®ËØ•ÈòüÂàóÊó∂ÔºåÊù•‰ªªÂä°ÂêéÔºåËã•Á∫øÁ®ãÊ±†Á∫øÁ®ãÊï∞‰∏çË∂ÖËøáÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÔºåÂàôÊñ∞Âª∫Á∫øÁ®ãÂ§ÑÁêÜËØ•‰ªªÂä°ÔºåËã•ËææÂà∞‰∫ÜÊ†∏ÂøÉÁ∫øÁ®ãÊï∞ÔºåÂàôÂ∞Ü‰ªªÂä°Âä†ÂÖ•ÊúâÁïåÈòüÂàó„ÄÇÂΩìÊúâÁïåÈòüÂàóÊª°Êó∂ÔºåÂà§Êñ≠Á∫øÁ®ãÊ±†Á∫øÁ®ãÊï∞ÊòØÂê¶ËææÂà∞ÊúÄÂ§ßÁ∫øÁ®ãÊï∞ÔºåÊ≤°ËææÂà∞ÂàôÂàõÂª∫Êñ∞Á∫øÁ®ãÂ§ÑÁêÜÔºåËææÂà∞ÂàôÊâßË°åÊãíÁªùÁ≠ñÁï•„ÄÇ Á∫øÁ®ãÊ±†ÊãíÁªùÁ≠ñÁï• javaÁöÑÁ∫øÁ®ãÊ±†ÊãíÁªùÁ≠ñÁï•ÊúâÔºö AbortPolicy: ÈªòËÆ§ÁöÑÊãíÁªùÁ≠ñÁï•ÔºåÊäõÂá∫ÂºÇÂ∏∏Ôºå‰ΩÜÁ≥ªÁªüÊ≠£Â∏∏Â∑•‰ΩúCallerRunsPolicyÔºöÂè™Ë¶ÅÁ∫øÁ®ãÊ±†Êú™ÂÖ≥Èó≠ÔºåÂàôËøêË°åÂΩìÂâçË¢´‰∏¢ÂºÉÁöÑ‰ªªÂä°DiscardOldestPolicy: ‰∏¢ÂºÉÁ≠âÂæÖÈòüÂàóÊúÄÊó©ÁöÑËØ∑Ê±ÇÔºåÂ∞ùËØïÂÜçÊ¨°Êèê‰∫§ÂΩìÂâç‰ªªÂä°DiscardPolicy: ‰∏¢ÂºÉÊó†Ê≥ïÂ§ÑÁêÜÁöÑ‰ªªÂä°Ôºå‰∏çÂÅö‰ªª‰ΩïÂ§ÑÁêÜ Ê≠§Â§ñÔºåÂèØ‰ª•Ëá™ÂÆö‰πâÊãíÁªùÁ≠ñÁï•(ÈªòËÆ§ÁöÑÂá†ÁßçÊãíÁªùÁ≠ñÁï•‰∏çÊòØÂæàÂ•Ω)ÔºåÂè™ÈúÄË¶ÅÂÆûÁé∞RejectedExecutionHandlerÊé•Âè£ÔºåÈáçÂÜôrejectedExecutionÊñπÊ≥ïÂç≥ÂèØ„ÄÇÂ§ÑÁêÜÈÄªËæëÂèØ‰ª•ÊääÊó†Ê≥ïÂ§ÑÁêÜÁöÑ‰ªªÂä°ËÆ∞ÂΩïÊó•ÂøóÔºå‰πãÂêéÁ©∫Èó≤Êó∂ÂéªÂ§ÑÁêÜ„ÄÇÊàñËÄÖÁªô‰ªªÂä°ÂèëÈÄÅÁ´ØÂõûÂ∫îÔºåËÆ©ÂÖ∂Á≠âÁü≠‰∏ÄÊÆµÊó∂Èó¥ÂÜçÂèë‰ªªÂä°„ÄÇ Â¶ÇÊúâÈîôËØØÔºåÂä°ÂøÖÊåáÂá∫ÔºåÂçÅÂàÜÊÑüË∞¢„ÄÇ ‰ΩúËÄÖ ÔºöÁ®ãÂ∫èÁåøQQ2018Âπ¥ 06Êúà 23Êó• Êó•Â∏∏Ê≠åÊõ≤Êé®Ëçê A Story of Fate - Jannik]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>ThreadPool</tag>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[XMPPÂçèËÆÆSASLËÆ§ËØÅÊµÅÁ®ã]]></title>
    <url>%2F2018%2F06%2F20%2FXMPPSASL%2F</url>
    <content type="text"><![CDATA[XMPPÂçèËÆÆSASLËÆ§ËØÅÊµÅÁ®ã‚Äî‰ª•openfireÊúçÂä°Âô®‰∏∫‰æã XMPPÂçèËÆÆÁöÑÂÆåÊï¥ÁôªÂΩïÊµÅÁ®ã‰∏∫Ôºö TLSÂçèÂïÜÔºåÊûÑÂª∫Âä†ÂØÜÈÄöÈÅì SASLÂçèÂïÜÔºåËøõË°åÁôªÂΩïÈ™åËØÅ SASLÂçèÂïÜÂêéÂç≥ÁôªÂΩïÊàêÂäüÔºå‰πãÂêéËøõË°åËµÑÊ∫êÁªëÂÆöÔºàÁî®Êà∑ÂèØËÉΩÈÄöËøáÊâãÊú∫ÊàñÁîµËÑëÁ≠âÁôªÈôÜÔºâ ËøôÈáå‰∏ªË¶ÅËÆ®ËÆ∫SASLÂçèÂïÜÔºåÂÅáËÆæÁé∞Âú®Â∑≤Âª∫Á´ãÂ•ΩTLSÂä†ÂØÜÈÄöÈÅì„ÄÇ step1 ÂÆ¢Êà∑Á´ØÂêëÊúçÂä°Âô®ÂèëÈÄÅ‰∏Ä‰∏™Êñ∞ÁöÑxmlÊµÅ„ÄÇ1&lt;stream:stream xmlns='jabber:client' to='localhost' xmlns:stream='http://etherx.jabber.org/streams' version='1.0' from='zhangsan@localhost' xml:lang='en'&gt; step2 ÊúçÂä°Âô®ÂêëÊúçÂä°Âô®ÂèëÈÄÅÂìçÂ∫îÊµÅ, Â£∞ÊòéÊúçÂä°Âô®ÊîØÊåÅÁöÑSASLÈ™åËØÅÊú∫Âà∂„ÄÇ123456789101112&lt;?xml version='1.0' encoding='UTF-8'?&gt;&lt;stream:stream xmlns:stream="http://etherx.jabber.org/streams" xmlns="jabber:client" from="localhost" id="45ulb20rwb" xml:lang="en" version="1.0"&gt;&lt;stream:features&gt; &lt;mechanisms xmlns="urn:ietf:params:xml:ns:xmpp-sasl"&gt; &lt;mechanism&gt;PLAIN&lt;/mechanism&gt; &lt;mechanism&gt;SCRAM-SHA-1&lt;/mechanism&gt; &lt;mechanism&gt;CRAM-MD5&lt;/mechanism&gt; &lt;mechanism&gt;DIGEST-MD5&lt;/mechanism&gt; &lt;/mechanisms&gt; &lt;compression xmlns="http://jabber.org/features/compress"&gt;&lt;method&gt;zlib&lt;/method&gt;&lt;/compression&gt; &lt;ver xmlns="urn:xmpp:features:rosterver"/&gt; &lt;register xmlns="http://jabber.org/features/iq-register"/&gt;&lt;/stream:features&gt; step3 ÂÆ¢Êà∑Á´ØÂêëÊúçÂä°Âô®ÂèëÈÄÅauthÊµÅÔºåÂ£∞ÊòéÂÆ¢Êà∑Á´ØÈÄâÊã©ÁöÑSASLÈ™åËØÅÊú∫Âà∂ÔºåopenfireÊúçÂä°Âô®ÈªòËÆ§ÊòØSCRAM-SHA-1authÊµÅÂÜÖÂÆπÔºön=Áî®Êà∑Âêçr=ÂÆ¢Êà∑Á´ØÈöèÊú∫Êï∞123&lt;auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='SCRAM-SHA-1'&gt;biwsbj16aGFuZ3NhbixyPSNhTTRWeHdjO2ZzckZ2M3tuXnxHMVlTWWwzQEdCI1Va&lt;/auth&gt;ÁªèËøábase64Ëß£Á†ÅÂêéÔºön,,n=zhangsan,r=#aM4Vxwc;fsrFv3&#123;n^|G1YSYl3@GB#UZ ‚Äî‚Äî‚Äî‚Äî‚ÄîÂâçÊñπÈ´òËÉΩ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚ÄîÂèëÁé∞ÁΩë‰∏ä‰∏çÂ∞ëÂçöÂÆ¢ËØ¥ÁöÑÈÉΩÊòØPLAINÊú∫Âà∂ÁöÑÈ™åËØÅÊµÅÁ®ãÔºåÊ≠§Â§Ñ‰ªéÊ∫êÁ†ÅÂ±ÇÈù¢ÂâñÊûê‰∏ãSCRAM-SHA-1Êú∫Âà∂„ÄÇÂõ†‰∏∫PLAINÊú∫Âà∂ÔºåÂÆ¢Êà∑Á´Ø‰ºöÊääÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÂèëÁªôÊúçÂä°Âô®Ôºå‰∏çÁªèËøáÂä†ÂØÜÔºåÂè™ÊòØbase64ÁºñÁ†Å‰∫Ü‰∏Ä‰∏ã„ÄÇÊúçÂä°Âô®‰ºö‰ªéÊï∞ÊçÆÂ∫ì(‰æãÂ¶ÇmysqlÊï∞ÊçÆÂ∫ì)ÁöÑofUserË°®‰∏≠ÂèñÂá∫ÂØÜÁ†ÅÔºåËß£ÂØÜÂêé‰∏éÂÆ¢Êà∑Á´Ø‰º†Êù•ÁöÑÂØÜÁ†ÅÊØîÂØπÂç≥ÂèØ„ÄÇ‰∏çÂ§üÂÆâÂÖ®„ÄÇÊÑüÂÖ¥Ë∂£ÂèØ‰ª•Áúã‰∏ãSaslServerPlainImplÁ±ªÁöÑevaluateResponseÊñπÊ≥ï„ÄÇ ‰∏ãÈù¢‰ªãÁªçSCRAM-SHA-1ÁöÑÊµÅÁ®ã„ÄÇÊúçÂä°Âô®Êé•Êî∂Âà∞authÊµÅÂêéÔºåStanzaHandlerÁ±ªÁöÑprocessÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇprocessÊñπÊ≥ïÂÖ≥ÈîÆ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö 123456else if ("auth".equals(tag)) &#123; startedSASL = true; saslStatus = SASLAuthentication.handle(session, doc);&#125; else if (startedSASL &amp;&amp; "response".equals(tag) || "abort".equals(tag)) &#123; saslStatus = SASLAuthentication.handle(session, doc);&#125; Âà§Êñ≠xmlÊµÅÁöÑÁ±ªÂûãÊòØauthÂêéÔºå‰ºöË∞ÉÁî®SASLAuthentication.handle()ÊñπÊ≥ïÔºåÂÖ∂ÂÆû‰πãÂêéÂÆ¢Êà∑Á´ØÂèëÊù•ÁöÑresponseÊµÅÊàñabortÊµÅ‰πüÊòØË∞ÉÁî®ËØ•ÊñπÊ≥ï„ÄÇhandleÊñπÊ≥ï‰∏≠‰ºöÂà§Êñ≠ËØ•xmlÊµÅÊòØauthËøòÊòØresponse„ÄÇ1234567891011121314switch ( ElementType.valueOfCaseInsensitive( doc.getName() ) ) &#123; case ABORT: throw new SaslFailureException( Failure.ABORTED ); case AUTH: ... SaslServer saslServer = Sasl.createSaslServer( mechanismName, "xmpp", serverName, props, new XMPPCallbackHandler() ); ... session.setSessionData( "SaslServer", saslServer ); ... case RESPONSE: // Either a challenge or success data. final byte[] challenge = saslServer.evaluateResponse( decoded ); Âà§Êñ≠ÊòØauthÂêéÔºå‰∏ªË¶ÅÂ∞±ÊòØÂàõÂª∫‰∫ÜSaslserverÊúçÂä°Âô®Ôºå‰ºöÊ†πÊçÆ‰πãÂâçÊâÄÈÄâÁöÑSASLÈ™åËØÅÊú∫Âà∂ÂàõÂª∫ÂØπÂ∫îÁöÑÊúçÂä°Âô®„ÄÇÊ≠§Â§ÑÂàõÂª∫ÁöÑÊòØScramSha1SaslServerÊúçÂä°Âô®ÔºåÂú®SaslServerFactoryImplÁ±ªÁöÑcreateSaslServerÊñπÊ≥ï‰∏≠ÂàõÂª∫Ôºå‰ª£Á†ÅÂ¶Ç‰∏ãÔºö12345678910111213case "PLAIN": return new SaslServerPlainImpl( protocol, serverName, props, cbh );case "SCRAM-SHA-1": return new ScramSha1SaslServer();case "ANONYMOUS": return new AnonymousSaslServer( session );case "EXTERNAL": if ( session instanceof LocalClientSession ) return new ExternalClientSaslServer( (LocalClientSession) session ); if ( session instanceof LocalIncomingServerSession ) return new ExternalServerSaslServer( (LocalIncomingServerSession) session );case JiveSharedSecretSaslServer.NAME: return new JiveSharedSecretSaslServer(); ScramSha1SaslServerÁ±ª‰ºöÂú®Êî∂Âà∞authÊµÅÂêéÂêëÂÆ¢Êà∑Á´ØÂèëÈÄÅchallengeÊµÅÔºå‰πãÂêéÂÆ¢Êà∑Á´Ø‰ºöÂèëÂá∫Â∫îÁ≠îÊµÅresponseÔºåÁªèËøáSASLAuthentication.handle()ÊñπÊ≥ïÂ§ÑÁêÜÂêé‰πüÊòØ‰∫§ÁªôScramSha1SaslServerÁ±ªËøõË°åÈ™åËØÅ„ÄÇ ‚Äî‚Äî‚Äî‚Äî‚ÄîÂâçÊñπÊûÅÂ∫¶È´òËÉΩ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî12345678910111213141516171819202122private State state = State.INITIAL; //stateÂàùÂßãÂåñÊó∂ÁöÑÁä∂ÊÄÅ...switch (state) &#123; case INITIAL: challenge = generateServerFirstMessage(response); state = State.IN_PROGRESS; //ÊúçÂä°Âô®ÂèëÈÄÅchallengeÂêéÁä∂ÊÄÅÂèò‰∏∫IN_PROGRESS break; case IN_PROGRESS: challenge = generateServerFinalMessage(response); state = State.COMPLETE; //ÊúçÂä°Âô®È™åËØÅÂÆåresponseÂêéÁä∂ÊÄÅÂèò‰∏∫COMPLETE break; case COMPLETE: if (response == null || response.length == 0) &#123; challenge = new byte[0]; break; &#125; default: throw new SaslException("No response expected in state " + state); &#125; step4 generateServerFirstMessageÊñπÊ≥ïË¥üË¥£ÂØπauthÊµÅËøõË°åÂ§ÑÁêÜÂπ∂ÂèëÂá∫challengeÊµÅ„ÄÇ12345678910111213private byte[] generateServerFirstMessage(final byte[] response) throws SaslException &#123; String clientFirstMessage = new String(response, StandardCharsets.UTF_8); Matcher m = CLIENT_FIRST_MESSAGE.matcher(clientFirstMessage); if (!m.matches()) &#123; throw new SaslException("Invalid first client message"); &#125; clientFirstMessageBare = m.group(5); username = m.group(6); //‰ªéauthÊµÅ‰∏≠ÂæóÂà∞Áî®Êà∑Âêç String clientNonce = m.group(7); //‰ªéauthÊµÅ‰∏≠ÂæóÂà∞ÂÆ¢Êà∑Á´ØÈöèÊú∫Êï∞ nonce = clientNonce + UUID.randomUUID().toString(); //ÂØπÂÆ¢Êà∑Á´ØÈöèÊú∫Êï∞ÂÜçÊ¨°ÈöèÊú∫Ôºå‰πãÂêé‰ºöÂØπÂÖ∂È™åËØÅ serverFirstMessage = String.format("r=%s,s=%s,i=%d", nonce, DatatypeConverter.printBase64Binary(getSalt(username)),getIterations(username)); //ÂáÜÂ§áÂèëÁªôÂÆ¢Êà∑Á´ØÁöÑchallengeÊµÅ return serverFirstMessage.getBytes(StandardCharsets.UTF_8);&#125; challengeÊµÅÂÜÖÂÆπÔºör=ÊúçÂä°Á´ØÈöèÊú∫Êï∞(ÂÆ¢Êà∑Á´ØÈöèÊú∫Êï∞+UUID)s=salt(base64ÁºñÁ†ÅÁöÑÁõêÔºåÂ≠òÂÇ®Âú®openfirefÊúçÂä°Á´ØÊï∞ÊçÆÂ∫ìÁöÑofUserË°®‰∏≠)i =Ëø≠‰ª£Ê¨°Êï∞(Â≠òÂÇ®Âú®openfirefÊúçÂä°Á´ØÊï∞ÊçÆÂ∫ìÁöÑofUserË°®‰∏≠) 123&lt;challenge xmlns="urn:ietf:params:xml:ns:xmpp-sasl"&gt;cj0jYU00Vnh3Yztmc3JGdjN7bl58RzFZU1lsM0BHQiNVWjA3MzAzYzgwLWM2YTctNGRjMC1iZmUyLWVjODNlYmJmY2FlMCxzPVdmckVRTXVmZVdCSmoxS0dUR0p5aVJuaGIrWVJFQzZKLGk9NDA5Ng==&lt;/challenge&gt;Ëß£Á†ÅÂêéÂÜÖÂÆπ‰∏∫Ôºör=#aM4Vxwc;fsrFv3&#123;n^|G1YSYl3@GB#UZ07303c80-c6a7-4dc0-bfe2-ec83ebbfcae0,s=WfrEQMufeWBJj1KGTGJyiRnhb+YREC6J,i=4096 step5 ÂÆ¢Êà∑Á´Ø‰ºöÊ†πÊçÆÁî®Êà∑ËæìÂÖ•ÂØÜÁ†Å„ÄÅ‰ªéÊúçÂä°Âô®challengeÊµÅ‰∏≠Ëé∑ÂæóÁöÑÁõêÂíåËø≠‰ª£Ê¨°Êï∞ÔºåËÆ°ÁÆóÂá∫‰∏Ä‰∫õÊï∞ÂÄºÔºåÂπ∂‰Ωú‰∏∫responseÊµÅÂèëÁªôÊúçÂä°Âô®ÂéªÈ™åËØÅ„ÄÇ123456789101112clientFinalMessageBare = "c=biws,r=ÊúçÂä°Á´ØÈöèÊú∫Êï∞"saltedPassword = PBKDF2-SHA-1(normalizedPassword, salt, i)clientKey = HMAC-SHA-1(saltedPassword, "ÂÆ¢Êà∑Á´ØÂØÜÈí•")storedKey = SHA-1(clientKey)authMessage = authÊµÅÂÜÖÂÆπ+","+challengeÊµÅÂÜÖÂÆπ+","clientFinalMessageBareclientSignature = HMAC-SHA-1(storedKey, authMessage)clientProof = clientKey ÂºÇÊàñ clientSignatureserverKey = HMAC-SHA-1(saltedPassword, "ÊúçÂä°Á´ØÂØÜÈí•")serverSignature = HMAC-SHA-1(serverKey, authMessage)clientFinalMessage = clientFinalMessageBare",p="base64(clientProof)"ÂÆ¢Êà∑Á´ØÂØπclientFinalMessageËøõË°åbase64ÁºñÁ†ÅÂπ∂Â∞ÜÂÖ∂‰Ωú‰∏∫responseÊµÅÂèëÈÄÅÁªôÊúçÂä°Âô® responseÊµÅÂÜÖÂÆπÔºöc=biwsr=ÊúçÂä°Á´ØÈöèÊú∫Êï∞p=base64(clientProof)123&lt;response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'&gt;Yz1iaXdzLHI9I2FNNFZ4d2M7ZnNyRnYze25efEcxWVNZbDNAR0IjVVowNzMwM2M4MC1jNmE3LTRkYzAtYmZlMi1lYzgzZWJiZmNhZTAscD1QdUE5OGVSVXBBSGhqa2EwdDJ3dVQ1TFBvU1k9&lt;/response&gt;Ëß£Á†ÅÂêéÂÜÖÂÆπ‰∏∫Ôºöc=biws,r=#aM4Vxwc;fsrFv3&#123;n^|G1YSYl3@GB#UZ07303c80-c6a7-4dc0-bfe2-ec83ebbfcae0,p=PuA98eRUpAHhjka0t2wuT5LPoSY= step6 ScramSha1SaslServerÁ±ªÁöÑgenerateServerFinalMessageÊñπÊ≥ïË¥üË¥£ÂØπresponseÊµÅËøõË°åÈ™åËØÅÔºåÈ™åËØÅÈÄöËøá‰ºöÂêëÂÆ¢Êà∑Á´ØÂèëÈÄÅsuccessÊµÅ„ÄÇgenerateServerFinalMessageÊñπÊ≥ïÊ†∏ÂøÉ‰ª£Á†ÅÔºö1234567891011121314151617181920212223242526272829303132333435363738String clientFinalMessage = new String(response, StandardCharsets.UTF_8);Matcher m = CLIENT_FINAL_MESSAGE.matcher(clientFinalMessage);String clientFinalMessageWithoutProof = m.group(1);String clientNonce = m.group(3); //ÂÆ¢Êà∑Á´ØÂèëÊù•ÁöÑÊúçÂä°Âô®ÈöèÊú∫Êï∞String proof = m.group(4); //base64(clientProof) if (!nonce.equals(clientNonce)) &#123; //È™åËØÅÊúçÂä°Âô®‰πãÂâçÁîüÊàêÁöÑÈöèÊú∫Êï∞ÂíåÂÆ¢Êà∑Á´ØÂèëÊù•ÁöÑÊúçÂä°Âô®ÈöèÊú∫Êï∞ÊòØÂê¶‰∏ÄËá¥ throw new SaslException("Client final message has incorrect nonce value"); &#125; try &#123; String authMessage = clientFirstMessageBare + "," + serverFirstMessage + "," + clientFinalMessageWithoutProof; byte[] storedKey = getStoredKey( username ); //Ê†πÊçÆÁî®Êà∑ÂêçÊü•ÊâæÊúçÂä°Á´ØÂ≠òÂÇ®ÁöÑstoredKey if (storedKey == null) &#123; throw new SaslException("No stored key for user '"+username+"'"); &#125; byte[] serverKey = getServerKey(username); //Ê†πÊçÆÁî®Êà∑ÂêçÊü•ÊâæÊúçÂä°Á´ØÂ≠òÂÇ®ÁöÑserverKey if (serverKey == null) &#123; throw new SaslException("No server key for user '"+username+"'"); &#125; byte[] clientSignature = ScramUtils.computeHmac(storedKey, authMessage); byte[] serverSignature = ScramUtils.computeHmac(serverKey, authMessage); byte[] clientKey = clientSignature.clone(); byte[] decodedProof = DatatypeConverter.parseBase64Binary(proof); for (int i = 0; i &lt; clientKey.length; i++) &#123; clientKey[i] ^= decodedProof[i]; //Â∞ÜclientProof‰∏éclientSignatureËøõË°åÂºÇÊàñÔºåËøòÂéüÂá∫clientKey &#125; //Â∞ÜÊúçÂä°Á´ØÂ≠òÂÇ®ÁöÑstoredKeyÂíåclientKeyÁªèSHA-1ÁÆóÊ≥ïÂæóÂà∞ÂÄºËøõË°åÊØîÂØπ if (!Arrays.equals(storedKey, MessageDigest.getInstance("SHA-1").digest(clientKey))) &#123; throw new SaslException("Authentication failed"); &#125; //ÊØîÂØπÊàêÂäüÂàôË°®ÊòéÈ™åËØÅÊàêÂäüÔºåÂêëÂÆ¢Êà∑Á´ØÂèëÈÄÅsuccessÊµÅ return ("v=" + DatatypeConverter.printBase64Binary(serverSignature)) .getBytes(StandardCharsets.UTF_8); ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-ÂÖ≥ÈîÆÁÇπ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-ÂÆ¢Êà∑Á´ØÔºöclientKey ÂºÇÊàñ clientSignature = clientProofÊúçÂä°Á´ØÔºöclientProofÂºÇÊàñclientSignature=clientKeyÔºå‰æøÂèØËøòÂéüÂá∫clientKey„ÄÇÂÜçÂ∞ÜÊúçÂä°Á´ØÂ≠òÂÇ®ÁöÑstoredKeyÂíåclientKeyÁªèSHA-1ÁÆóÊ≥ïÂæóÂà∞ÂÄºËøõË°åÊØîÂØπÔºåÂç≥ÂèØÂÆåÊàêÈ™åËØÅ„ÄÇ successÊµÅÂÜÖÂÆπÔºöv=base64(serverSignature)123&lt;success xmlns="urn:ietf:params:xml:ns:xmpp-sasl"&gt;dj1WZUtxOFFTRFBTbXdaNUM2V1hvanZTTzJwdTA9&lt;/success&gt;Ëß£Á†ÅÂêéÂÜÖÂÆπ‰∏∫Ôºöv=VeKq8QSDPSmwZ5C6WXojvSO2pu0= Ëá≥Ê≠§ÔºåXMPPÂçèËÆÆÁöÑSASLÂçèÂïÜÂÆåÊàêÔºå‰πãÂêéÂÆ¢Êà∑Á´ØÂèëÈÄÅÊñ∞ÁöÑÊµÅÔºåÂÆåÊàêËµÑÊ∫êÁªëÂÆöÁ≠âÊµÅÁ®ã„ÄÇTip: Âª∫ËÆÆ‰∏ãËΩΩopenfireÊ∫êÁ†ÅË∑ë‰∏Ä‰∏ãÊµÅÁ®ã„ÄÇ Â¶ÇÊúâÈîôËØØÔºåÂä°ÂøÖÊåáÂá∫ÔºåÂçÅÂàÜÊÑüË∞¢„ÄÇ ‰ΩúËÄÖ ÔºöÁ®ãÂ∫èÁåøQQ2018Âπ¥ 06Êúà 20Êó• Êó•Â∏∏Ê≠åÊõ≤Êé®Ëçê secret base ~Âêõ„Åå„Åè„Çå„Åü„ÇÇ„ÅÆ~ (10 years after Ver.)]]></content>
      <categories>
        <category>XMPP</category>
      </categories>
      <tags>
        <tag>XMPP</tag>
        <tag>SASL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[30‰∏áÁü•‰πéÁî®Êà∑Êï∞ÊçÆÁà¨Ëô´ÂàÜÊûê]]></title>
    <url>%2F2018%2F05%2F26%2Fzhihu-pachong%2F</url>
    <content type="text"><![CDATA[Áà¨ÂèñÁü•‰πé30‰∏áÁî®Êà∑‰ø°ÊÅØÔºàÂéªÈáçÂêéÔºâÔºåÂπ∂‰ªéÁà¨ÂèñÊï∞ÊçÆÁöÑÂêÑÁª¥Â∫¶ËøõË°åÂàÜÊûêÔºåÊé¢Á¥¢Áü•‰πéÁî®Êà∑Áæ§‰ΩìÁöÑ‰∏Ä‰∫õËßÑÂæã„ÄÇ ÈáçÁÇπ ÈááÁî®MongoDBÂ≠òÂÇ®Êï∞ÊçÆ ‰∏∫Â∫îÂØπÂçï‰∏™ipÁà¨ÂèñË¢´Â∞ÅÁöÑÊÉÖÂÜµÔºåÈááÁî®‰ª£ÁêÜipÊ±†ËøõË°åÁà¨Ëô´ ‰∏∫ÊèêÈ´òÁà¨ÂèñÈÄüÂ∫¶ÔºåÈááÁî®Â§öÁ∫øÁ®ãËøõË°åÁà¨ÂèñÔºàÈááÁî®pythonËØ≠Ë®ÄÔºâ ‰∏∫ÊèêÈ´òÁî®Êà∑Ë¥®ÈáèÔºåÂè™Áà¨ÂèñÁî®Êà∑ÁöÑÂÖ≥Ê≥®ÂàóË°® ÂõæË°®Â±ïÁ§∫ÈááÁî®BDPÔºå‰∏ÄÊ¨æ‰∫ëÁ´ØÂèØËßÜÂåñÊï∞ÊçÆÂàÜÊûêÂ∑•ÂÖ∑ Áî®Êà∑ÂàÜÊûê Êú¨ÂàÜÊûê‰∏çÂÖ∑Êúâ‰ª£Ë°®ÊÄß,Âè™ÈíàÂØπÂ∑≤Áà¨ÂèñÁöÑ30‰∏áÊï∞ÊçÆ Â±ïÁ§∫ÂõæË°®Â¶Ç‰∏ãÔºö Áü•‰πéÁî®Êà∑ÊÄßÂà´ÂØπÊØîÂèØ‰ª•ÁúãÂá∫Áü•‰πéÁî®Êà∑Áæ§‰Ωì‰∏≠Áî∑ÊÄßÂç†ÊØîÊúÄÂ§ßÔºåÂ•≥ÊÄßÂÖ∂Ê¨°ÔºåËøòÊúâ‰∏ÄÈÉ®ÂàÜÁî®Êà∑ÊÄßÂà´Êú™Áü•ÔºåÈöæÈÅìÊúâÂÖ∂‰ªñÊÄßÂà´Ôºü Áü•‰πéÁî®Êà∑Á≤â‰∏ùÊï∞ÈáèÊéíÂêçÂº†ÂÖ¨Â≠êÈ¢ÜË∑ëÁ≤â‰∏ùÊï∞ÈáèÊéíË°åÊ¶úÔºåÁ≤â‰∏ùÊï∞ÈáèË∂ÖËøá150Â§ö‰∏á„ÄÇ‰∏ÅÈ¶ôÂåªÁîü„ÄÅÊùéÂºÄÂ§çÁ≤â‰∏ùÊï∞Èáè‰πüË∂ÖËøá100‰∏áÂ§ßÂÖ≥ÔºåËΩÆÂ≠êÂì•ÊéíÂêç‰πüÈùûÂ∏∏Èù†Ââç„ÄÇ Áü•‰πéÁî®Êà∑Ëé∑ÂæóÊÑüË∞¢Êï∞ÈáèÊéíÂêçÂº†ÂÖ¨Â≠êÁªßÁª≠È¢ÜË∑ëÊÑüË∞¢Êï∞ÈáèÊéíË°åÊ¶ú Áü•‰πéÁî®Êà∑Ëé∑ËµûÊï∞ÈáèÊéíÂêçÂº†ÂÖ¨Â≠êËøòÊòØÈ¢ÜË∑ëËé∑ËµûÊï∞ÈáèÊéíË°åÊ¶úÔºåÂø´Á™ÅÁ†¥500‰∏áÂ§ßÂÖ≥‰∫Ü„ÄÇ Áü•‰πéÁî®Êà∑Ë°å‰∏öÂàÜÂ∏É‰ªéÁü•‰πéÁî®Êà∑Ë°å‰∏öÂàÜÂ∏É‰∏≠ÂèØ‰ª•ÁúãÂá∫ÔºåITË°å‰∏öÁâ¢Áâ¢Âç†ÊçÆÊ¶úÈ¶ñÔºåÊïôËÇ≤„ÄÅÈáëËûç„ÄÅÊ≥ïÂæãÂíåÂåªÂ≠¶Á≠âÈ¢ÜÂüüÊéíÂêç‰πüÂæàÈù†Ââç„ÄÇ Áü•‰πéÁî®Êà∑Èô¢Ê†°ÂàÜÂ∏ÉÁü•‰πéÁî®Êà∑Â∞±ËØªÈô¢Ê†°Top10Ê∏Ö‰∏ÄËâ≤985Ôºå‰∏çÊòØÊ∏ÖÂåóÁúüÊòØ‰∏çÂ•ΩÊÑèÊÄùÂæÄ‰∏äÂÜô„ÄÇ Áü•‰πéÁî®Êà∑Áé∞Â±ÖÂú∞ÂàÜÂ∏É‰ªéÁü•‰πéÁî®Êà∑Â±Ö‰ΩèÂú∞ÂèØ‰ª•ÁúãÂá∫ÔºåÁü•‰πéÁî®Êà∑‰∏ªË¶ÅÊ¥ªË∑ÉÂú®Âåó‰∏äÂπøÊ∑±Á≠â‰∏ÄÁ∫øÂüéÂ∏Ç„ÄÇ Áü•‰πéÁî®Êà∑‰∏™‰∫∫ÁÆÄ‰ªãËØçÈ¢ëÁªüËÆ°‰ªéÁü•‰πéÁî®Êà∑‰∏™‰∫∫ÁÆÄ‰ªãËØçÈ¢ëÁªüËÆ°ÂèØ‰ª•ÁúãÂá∫ÔºåÁü•‰πéÁöÑÁî®Êà∑Áæ§‰ΩìÂ≠¶ÁîüÂç†ÊØîÊØîËæÉÂ§ß„ÄÇ Áü•‰πéÁî®Êà∑‰∏™ÊÄßÁ≠æÂêçËØçÈ¢ëÁªüËÆ°‰ªéÁü•‰πéÁî®Êà∑‰∏™ÊÄßÁ≠æÂêçËØçÈ¢ëÁªüËÆ°ÂèØ‰ª•ÁúãÂá∫ÔºåÁî®Êà∑ÂÄæÂêëÂú®‰∏™ÊÄßÁ≠æÂêç‰∏≠Â°´ÂÜôËÅå‰∏öÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØ„ÄÇ ÊÄªÁªì Áà¨ÂèñÁöÑÁî®Êà∑Êï∞Èáè‰∏çÊòØÂæàÂ§ßÔºåÊ≤°ÊúâÂæàÂº∫ÁöÑ‰ª£Ë°®ÊÄßÔºõ ÂèØ‰ª•Ëøõ‰∏ÄÊ≠•ËøõË°åÁî®Êà∑Áõ∏ÂÖ≥ÊÄßÂàÜÊûêÔºõ Êó•Â∏∏Ê≠åÊõ≤Êé®Ëçê Áâµ‰∏ùÊàè - Èì∂‰∏¥/AkiÈòøÊù∞]]></content>
      <categories>
        <category>Áà¨Ëô´</category>
      </categories>
      <tags>
        <tag>Áà¨Ëô´</tag>
        <tag>Áü•‰πé</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GithubÂçöÂÆ¢ÁªëÂÆö‰∏™ÊÄßÂüüÂêç]]></title>
    <url>%2F2018%2F05%2F20%2Fgithub-domain%2F</url>
    <content type="text"><![CDATA[È¶ñÂÖàÊàë‰ª¨ÂÖà‰π∞‰∏™ÂüüÂêç,ÂèØ‰ª•Âú®ÈòøÈáå‰∫ëË¥≠‰π∞ÂüüÂêçÔºå‰π∞ÂÆå‰πãÂêéÁôªÈôÜÈòøÈáå‰∫ëÁÆ°ÁêÜÊéßÂà∂Âè∞,ÁÑ∂ÂêéÁÇπÂáªÂüüÂêçÔºåÂÜçÁÇπÂáªËß£ÊûêÂ¶Ç‰∏ã„ÄÇ ÂüüÂêçËß£Êûê Êé•‰∏ãÊù•ÁÇπÂáªÊ∑ªÂä†Ëß£ÊûêÔºåÂπ∂ËæìÂÖ•‰ª•‰∏ã‰ø°ÊÅØÔºàËÆ∞ÂΩïÂÄº‰∏ç‰∏ÄÊ†∑ÔºåÁ¨¨‰∏Ä‰∏™ÁöÑËÆ∞ÂΩïÂÄºÂ°´‰Ω†ÁöÑgithubËÆøÈóÆÂú∞ÂùÄ,Â¶Çwu-hrq.github.io,Á¨¨‰∫å‰∏™Â°´ÁöÑÊòØ‰Ω†ÁöÑÁΩëÁ´ôÁöÑipÂú∞ÂùÄÔºåÊØîÂ¶ÇÊàëÂéüÊù•ÁöÑÁΩëÁ´ôÊòØwu-hrq.github.io,ÈÇ£‰πàÂ∞±Êü•Êâæwu-hrq.github.ioÁöÑipÂú∞ÂùÄÔºåÁΩëÁ´ôÁöÑipÂú∞ÂùÄÂèØ‰ª•Âú®ËøôÊü•ipÂú∞ÂùÄ„ÄÇ ÁÑ∂ÂêéÂêë‰Ω†ÁöÑ Github Pages ‰ªìÂ∫ìÊ∑ªÂä†‰∏Ä‰∏™CNAME(‰∏ÄÂÆöË¶ÅÂ§ßÂÜô)Êñá‰ª∂ÔºåÂú®CNAMEÈáåÈù¢Ê∑ªÂä†‰Ω†ÁöÑÂüüÂêç‰ø°ÊÅØÔºà‰∏çÂä†http://ÔºâÔºåÂ¶Çshenzekun.cn,Âπ∂‰∏ä‰º†Âà∞‰Ω†ÁöÑGitHub‰∏≠ Â°´ÂÆå‰πãÂêéÁôªÈôÜ‰Ω†ÂçöÂÆ¢ÁöÑgithubÔºåÁÇπÂáªsetting Âú®ËøôÂ°´ÂÜô‰Ω†ÁöÑÂüüÂêçÔºåÁÇπÂáª‰øùÂ≠òÂç≥ÂèØ Êé•‰∏ãÊù•Â∞±ÊòØÁ≠â‰∫ÜÔºåÊàëÁöÑÂçöÂÆ¢Â§ßÊ¶ÇÂçä‰∏™Â∞èÊó∂Â∞±ÂèØ‰ª•ÁúãÂà∞‰∫Ü„ÄÇüòù Êó•Â∏∏Ê≠åÊõ≤Êé®Ëçê ÊµÆÁîüÊú™Ê≠á - Èü≥È¢ëÊÄ™Áâ©]]></content>
      <categories>
        <category>Github</category>
      </categories>
      <tags>
        <tag>ÂçöÂÆ¢</tag>
        <tag>ÂüüÂêç</tag>
        <tag>Github</tag>
      </tags>
  </entry>
</search>
